import{j as e,X as s,aF as a,aj as l,a_ as r,aI as t,aG as i,s as d,J as n}from"./03-hero-critical-BKzCa96P.js";import{r as c}from"./01-react-core-DCvPBpDR.js";import{B as m}from"./04-ui-components-DpbmxBFV.js";import{I as o}from"./05-admin-bundle-BW3OFzIa.js";import{T as u,a as x,b as p,c as h,d as j,e as v}from"./99-table-DV3dN7kr.js";import{S as _,a as y,b as g,c as f,d as b}from"./99-select-CL9TI2Dz.js";import{I as N}from"./99-image-uploader-KY2aE3Hk.js";import"./02-react-router-l50u7dmW.js";import"./06-utils-QQqVvbBo.js";import"./99-index-CxCer4qO.js";import"./99-index-D5v_MFz8.js";const w=()=>{const[w,k]=c.useState([]),[C,D]=c.useState(!0),[T,S]=c.useState(null),[I,q]=c.useState(!1),[A,F]=c.useState("2d"),[U,z]=c.useState({name:"",name_tr:"",type:"2d",model_url:"",texture_url:"",preview_url:"",is_active:!0,display_order:0}),P=async()=>{try{D(!0);const{data:e,error:s}=await d.from("design_templates").select("*").order("display_order");if(s)throw s;k(e||[])}catch(e){n.error("Failed to load design templates")}finally{D(!1)}};c.useEffect((()=>{P()}),[]);const R=e=>{const{name:s,value:a}=e.target;z({...U,[s]:a})},L=(e,s)=>{z({...U,[e]:s})},V=()=>{z({name:"",name_tr:"",type:"2d",model_url:"",texture_url:"",preview_url:"",is_active:!0,display_order:w.length+1}),q(!1),S(null)},E=e=>{z({...U,preview_url:e})};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Design Templates"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(_,{value:A,onValueChange:F,children:[e.jsx(y,{className:"w-40",children:e.jsx(g,{placeholder:"Filter by type"})}),e.jsxs(f,{children:[e.jsx(b,{value:"2d",children:"2D Templates"}),e.jsx(b,{value:"3d",children:"3D Templates"})]})]}),e.jsxs(m,{onClick:()=>{V(),q(!I)},variant:"default",children:[I?e.jsx(s,{className:"mr-2 h-4 w-4"}):e.jsx(a,{className:"mr-2 h-4 w-4"}),I?"Cancel":"Add Template"]})]})]}),I&&e.jsxs("div",{className:"bg-muted/50 p-4 mb-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add New Template"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Type"}),e.jsxs(_,{value:U.type,onValueChange:e=>L("type",e),children:[e.jsx(y,{children:e.jsx(g,{placeholder:"Select type"})}),e.jsxs(f,{children:[e.jsx(b,{value:"2d",children:"2D Template"}),e.jsx(b,{value:"3d",children:"3D Template"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),e.jsxs(_,{value:U.is_active?"true":"false",onValueChange:e=>z({...U,is_active:"true"===e}),children:[e.jsx(y,{children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(b,{value:"true",children:"Active"}),e.jsx(b,{value:"false",children:"Inactive"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name (English)"}),e.jsx(o,{name:"name",value:U.name,onChange:R,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name (Turkish)"}),e.jsx(o,{name:"name_tr",value:U.name_tr,onChange:R,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Display Order"}),e.jsx(o,{name:"display_order",type:"number",value:U.display_order,onChange:R,min:"0"})]}),"3d"===U.type?e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"3D Model URL"}),e.jsx(o,{name:"model_url",value:U.model_url,onChange:R,placeholder:"3D model URL (özellik yakında gelecek)",disabled:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"3D model desteği yakında eklenecek"})]}):e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Preview Image"}),e.jsx(N,{currentImageUrl:U.preview_url,onImageUploaded:E,bucketName:"designs",folderPath:"templates"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[e.jsx(m,{type:"button",variant:"outline",onClick:V,children:"Cancel"}),e.jsx(m,{type:"button",onClick:async()=>{try{if("3d"===U.type&&!U.model_url)return void n.error("3D model URL is required for 3D templates");if("2d"===U.type&&!U.preview_url)return void n.error("Preview image is required for 2D templates");const e={name:U.name,name_tr:U.name_tr,type:U.type,model_url:U.model_url,texture_url:U.texture_url,preview_url:"3d"===U.type?"":U.preview_url,is_active:U.is_active,display_order:U.display_order||w.length+1},{error:s}=await d.from("design_templates").insert(e);if(s)throw s;n.success("Template added successfully"),V(),P()}catch(e){n.error("Failed to add template")}},children:"Add Template"})]})]}),C?e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map((s=>e.jsx("div",{className:"h-14 bg-gray-200 dark:bg-gray-700 rounded"},s)))}):e.jsxs(u,{children:[e.jsx(x,{children:e.jsxs(p,{children:[e.jsx(h,{children:"Type"}),e.jsx(h,{children:"Name (EN)"}),e.jsx(h,{children:"Name (TR)"}),e.jsx(h,{children:"Preview"}),e.jsx(h,{children:"Order"}),e.jsx(h,{children:"Status"}),e.jsx(h,{className:"text-right",children:"Actions"})]})}),e.jsx(j,{children:0===w.filter((e=>""===A||e.type===A)).length?e.jsx(p,{children:e.jsx(v,{colSpan:7,className:"text-center py-8 text-gray-500",children:"No templates found for this type. Add a new one!"})}):w.filter((e=>""===A||e.type===A)).map((a=>e.jsx(p,{children:T===a.id?e.jsxs(e.Fragment,{children:[e.jsx(v,{children:e.jsxs(_,{value:U.type,onValueChange:e=>L("type",e),children:[e.jsx(y,{children:e.jsx(g,{placeholder:"Select type"})}),e.jsxs(f,{children:[e.jsx(b,{value:"2d",children:"2D"}),e.jsx(b,{value:"3d",children:"3D"})]})]})}),e.jsx(v,{children:e.jsx(o,{name:"name",value:U.name,onChange:R,required:!0})}),e.jsx(v,{children:e.jsx(o,{name:"name_tr",value:U.name_tr,onChange:R,required:!0})}),e.jsx(v,{children:"3d"===U.type?e.jsx("div",{children:e.jsx(o,{name:"model_url",value:U.model_url,onChange:R,placeholder:"3D Model URL (yakında)",disabled:!0})}):e.jsx(N,{currentImageUrl:U.preview_url,onImageUploaded:E,bucketName:"designs",folderPath:"templates"})}),e.jsx(v,{children:e.jsx(o,{name:"display_order",type:"number",value:U.display_order,onChange:R,min:"0",className:"w-20"})}),e.jsx(v,{children:e.jsxs(_,{value:U.is_active?"true":"false",onValueChange:e=>z({...U,is_active:"true"===e}),children:[e.jsx(y,{className:"w-24",children:e.jsx(g,{})}),e.jsxs(f,{children:[e.jsx(b,{value:"true",children:"Active"}),e.jsx(b,{value:"false",children:"Inactive"})]})]})}),e.jsxs(v,{className:"text-right space-x-2",children:[e.jsx(m,{size:"sm",variant:"outline",onClick:()=>S(null),children:e.jsx(s,{className:"h-4 w-4"})}),e.jsx(m,{size:"sm",onClick:()=>(async e=>{try{if("3d"===U.type&&!U.model_url)return void n.error("3D model URL is required for 3D templates");const s={name:U.name,name_tr:U.name_tr,type:U.type,model_url:U.model_url,texture_url:U.texture_url,is_active:U.is_active,display_order:U.display_order};"2d"===U.type&&Object.assign(s,{preview_url:U.preview_url});const{error:a}=await d.from("design_templates").update(s).eq("id",e);if(a)throw a;n.success("Template updated successfully"),S(null),P()}catch(s){n.error("Failed to update template")}})(a.id),children:e.jsx(l,{className:"h-4 w-4"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(v,{children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("3d"===a.type?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"),children:"3d"===a.type?"3D":"2D"})}),e.jsx(v,{children:a.name}),e.jsx(v,{children:a.name_tr}),e.jsx(v,{children:"3d"===a.type?a.model_url?e.jsxs("div",{className:"flex items-center",children:[e.jsx(r,{className:"h-5 w-5 mr-2 text-purple-500"}),e.jsx("span",{className:"text-xs truncate w-24",children:a.model_url})]}):e.jsx("span",{className:"text-red-500 text-xs",children:"No 3D model"}):a.preview_url?e.jsx("img",{src:a.preview_url,alt:a.name,className:"w-12 h-12 object-cover rounded-md"}):e.jsx("span",{className:"text-red-500 text-xs",children:"No image"})}),e.jsx(v,{children:a.display_order}),e.jsx(v,{children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(a.is_active?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"),children:a.is_active?"Active":"Inactive"})}),e.jsxs(v,{className:"text-right space-x-1",children:[e.jsx(m,{size:"icon",variant:"outline",onClick:()=>(async(e,s)=>{try{const{error:a}=await d.from("design_templates").update({is_active:!s}).eq("id",e);if(a)throw a;n.success(`Template ${s?"deactivated":"activated"} successfully`),P()}catch(a){n.error("Failed to update template status")}})(a.id,a.is_active),children:a.is_active?"Deactivate":"Activate"}),e.jsx(m,{size:"icon",variant:"outline",onClick:()=>(e=>{S(e.id),z({name:e.name||"",name_tr:e.name_tr||"",type:e.type||"2d",model_url:e.model_url||"",texture_url:e.texture_url||"",preview_url:e.preview_url||"",is_active:e.is_active,display_order:e.display_order||0})})(a),children:e.jsx(t,{className:"h-4 w-4"})}),e.jsx(m,{size:"icon",variant:"destructive",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this template?"))try{const{error:s}=await d.from("design_templates").delete().eq("id",e);if(s)throw s;n.success("Template deleted successfully"),P()}catch(s){n.error("Failed to delete template")}})(a.id),children:e.jsx(i,{className:"h-4 w-4"})})]})]})},a.id)))})]})]})};export{w as default};
