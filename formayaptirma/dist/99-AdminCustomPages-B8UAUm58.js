import{j as e,a7 as s,aF as t,aX as a,aU as n,I as i,aK as r,s as c,J as l}from"./03-hero-critical-BKzCa96P.js";import{r as d}from"./01-react-core-DCvPBpDR.js";import{T as o,a as h,b as m,c as g}from"./99-tabs-CCs0hPp1.js";import{C as x,g as _,h as u,D as p,n as j,B as v,j as f,k as w,l as y,m as N,o as F,i as C,f as b,p as q}from"./04-ui-components-DpbmxBFV.js";import{u as k,I as A}from"./05-admin-bundle-BW3OFzIa.js";import{L as S}from"./99-label-DtO75rKq.js";import{T}from"./99-textarea-BOZk7JoE.js";import{S as Q}from"./99-switch-BaDU39Q5.js";import{T as M,a as $,b as E,c as P,d as D,e as R}from"./99-table-DV3dN7kr.js";import"./02-react-router-l50u7dmW.js";import"./06-utils-QQqVvbBo.js";import"./99-index-CxCer4qO.js";import"./99-index-D5v_MFz8.js";const z=()=>{const{toast:z}=k(),[I,L]=d.useState("faq"),[U,H]=d.useState([]),[G,O]=d.useState(null),[V,B]=d.useState(null),[X,J]=d.useState([]),[K,W]=d.useState({}),[Y,Z]=d.useState(!0),[ee,se]=d.useState(!1),[te,ae]=d.useState(!1),[ne,ie]=d.useState(!1),[re,ce]=d.useState({question_tr:"",question_en:"",answer_tr:"",answer_en:"",is_active:!0});d.useEffect((()=>{(async()=>{Z(!0);try{const{data:e,error:s}=await c.from("faq_items").select("*").order("display_order",{ascending:!0});if(s)throw s;H(e||[]);const{data:t,error:a}=await c.from("page_contents").select("*").eq("page_type","shipping").single();if(a&&"PGRST116"!==a.code)throw a;O(t);const{data:n,error:i}=await c.from("page_contents").select("*").eq("page_type","returns").single();if(i&&"PGRST116"!==i.code)throw i;B(n);const{data:r,error:l}=await c.from("contact_messages").select("*").order("created_at",{ascending:!1});if(l)throw l;J(r||[]);const{data:d,error:o}=await c.from("page_contents").select("*").eq("page_type","contact").single();o&&"PGRST116"!==o.code||W(d||{contact_image_url:"https://static.wixstatic.com/media/abc862_cd0c5e510518448bbf8bbcd4eeccd577~mv2.jpg/v1/fill/w_950,h_701,al_c,q_85,usm_1.20_1.00_0.01,enc_avif,quality_auto/abc862_cd0c5e510518448bbf8bbcd4eeccd577~mv2.jpg"})}catch(e){l.error("Failed to load page data")}finally{Z(!1)}})()}),[]);const le=async(e,s,t)=>{const a=[...U];a[e]={...a[e],[s]:t},H(a)},de=async e=>{try{se(!0);const s="shipping"===e?G:V;if(null==s?void 0:s.id){const{error:e}=await c.from("page_contents").update({title_tr:s.title_tr,title_en:s.title_en,content_tr:s.content_tr,content_en:s.content_en,is_active:s.is_active}).eq("id",s.id);if(e)throw e}else{const{error:t}=await c.from("page_contents").insert([{page_type:e,title_tr:(null==s?void 0:s.title_tr)||"",title_en:(null==s?void 0:s.title_en)||"",content_tr:(null==s?void 0:s.content_tr)||"",content_en:(null==s?void 0:s.content_en)||"",is_active:(null==s?void 0:s.is_active)||!0}]);if(t)throw t}l.success(`${e.charAt(0).toUpperCase()+e.slice(1)} content saved successfully`)}catch(s){l.error(`Failed to save ${e} content`)}finally{se(!1)}},oe=async(e,s)=>{try{const{error:t}=await c.from("contact_messages").update({read:!s}).eq("id",e);if(t)throw t;J(X.map((t=>t.id===e?{...t,read:!s}:t))),l.success("Message marked as "+(s?"unread":"read"))}catch(t){l.error("Failed to update message status")}},he=async e=>{try{se(!0);const s={page_type:"contact",contact_image_url:e||K.contact_image_url,title_tr:"İletişim",title_en:"Contact",content_tr:"",content_en:"",is_active:!0};if(K.id){const{error:e}=await c.from("page_contents").update(s).eq("id",K.id);if(e)throw e}else{const{error:e}=await c.from("page_contents").insert([s]);if(e)throw e}l.success("Contact page settings saved")}catch(s){l.error("Failed to save contact settings")}finally{se(!1)}};return Y?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(s,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"container mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Manage Customer Service Pages"}),e.jsxs(o,{value:I,onValueChange:L,children:[e.jsxs(h,{className:"mb-6",children:[e.jsx(m,{value:"faq",children:"FAQ"}),e.jsx(m,{value:"shipping",children:"Shipping"}),e.jsx(m,{value:"returns",children:"Returns"}),e.jsx(m,{value:"contact-settings",children:"Contact Settings"}),e.jsx(m,{value:"contact-messages",children:"Contact Messages"})]}),e.jsx(g,{value:"faq",children:e.jsxs(x,{children:[e.jsxs(_,{children:[e.jsxs(u,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Frequently Asked Questions"}),e.jsxs(p,{open:ne,onOpenChange:ie,children:[e.jsx(j,{asChild:!0,children:e.jsxs(v,{children:[e.jsx(t,{className:"h-4 w-4 mr-2"}),"Add New FAQ"]})}),e.jsxs(f,{className:"sm:max-w-[600px]",children:[e.jsxs(w,{children:[e.jsx(y,{children:"Add New FAQ"}),e.jsx(N,{children:"Add a new question and answer to the FAQ section."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"question_tr",children:"Question (Turkish)"}),e.jsx(A,{id:"question_tr",value:re.question_tr,onChange:e=>ce({...re,question_tr:e.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"question_en",children:"Question (English)"}),e.jsx(A,{id:"question_en",value:re.question_en,onChange:e=>ce({...re,question_en:e.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"answer_tr",children:"Answer (Turkish)"}),e.jsx(T,{id:"answer_tr",value:re.answer_tr,onChange:e=>ce({...re,answer_tr:e.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:"answer_en",children:"Answer (English)"}),e.jsx(T,{id:"answer_en",value:re.answer_en,onChange:e=>ce({...re,answer_en:e.target.value})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{id:"is_active",checked:re.is_active,onCheckedChange:e=>ce({...re,is_active:e})}),e.jsx(S,{htmlFor:"is_active",children:"Active"})]})]}),e.jsxs(F,{children:[e.jsx(v,{variant:"outline",onClick:()=>ie(!1),children:"Cancel"}),e.jsxs(v,{onClick:async()=>{try{se(!0);const e=U.length>0?Math.max(...U.map((e=>e.display_order))):0,{data:s,error:t}=await c.from("faq_items").insert([{question_tr:re.question_tr,question_en:re.question_en,answer_tr:re.answer_tr,answer_en:re.answer_en,is_active:re.is_active,display_order:e+1}]).select();if(t)throw t;H([...U,s[0]]),ce({question_tr:"",question_en:"",answer_tr:"",answer_en:"",is_active:!0}),ie(!1),l.success("FAQ item added successfully")}catch(e){l.error("Failed to add FAQ item")}finally{se(!1)}},disabled:ee,children:[ee&&e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Add FAQ"]})]})]})]})]}),e.jsx(C,{children:"Manage the FAQ items displayed on the FAQ page."})]}),e.jsx(b,{className:"space-y-4",children:0===U.length?e.jsx("div",{className:"text-center py-4 text-gray-500",children:'No FAQ items found. Create one by clicking "Add New FAQ".'}):U.map(((t,i)=>e.jsxs(x,{className:"mb-4",children:[e.jsx(_,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"space-y-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{children:"Order:"}),e.jsx(A,{type:"number",value:t.display_order,onChange:e=>le(i,"display_order",parseInt(e.target.value)),className:"w-16 h-8"}),e.jsxs("div",{className:"ml-4 flex items-center gap-2",children:[e.jsx(Q,{id:`active-${t.id}`,checked:t.is_active,onCheckedChange:e=>le(i,"is_active",e)}),e.jsx(S,{htmlFor:`active-${t.id}`,children:"Active"})]})]})}),e.jsx(v,{variant:"destructive",size:"icon",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this FAQ item?"))try{se(!0);const{error:s}=await c.from("faq_items").delete().eq("id",e);if(s)throw s;H(U.filter((s=>s.id!==e))),l.success("FAQ item deleted successfully")}catch(s){l.error("Failed to delete FAQ item")}finally{se(!1)}})(t.id),children:e.jsx(a,{className:"h-4 w-4"})})]})}),e.jsxs(b,{className:"pt-0 grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:`question_tr-${t.id}`,children:"Question (Turkish)"}),e.jsx(A,{id:`question_tr-${t.id}`,value:t.question_tr,onChange:e=>le(i,"question_tr",e.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:`question_en-${t.id}`,children:"Question (English)"}),e.jsx(A,{id:`question_en-${t.id}`,value:t.question_en,onChange:e=>le(i,"question_en",e.target.value)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:`answer_tr-${t.id}`,children:"Answer (Turkish)"}),e.jsx(T,{id:`answer_tr-${t.id}`,value:t.answer_tr,onChange:e=>le(i,"answer_tr",e.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(S,{htmlFor:`answer_en-${t.id}`,children:"Answer (English)"}),e.jsx(T,{id:`answer_en-${t.id}`,value:t.answer_en,onChange:e=>le(i,"answer_en",e.target.value)})]})]})]}),e.jsx(q,{className:"justify-end",children:e.jsx(v,{onClick:()=>(async e=>{try{se(!0);const{error:s}=await c.from("faq_items").update({question_tr:e.question_tr,question_en:e.question_en,answer_tr:e.answer_tr,answer_en:e.answer_en,is_active:e.is_active,display_order:e.display_order}).eq("id",e.id);if(s)throw s;l.success("FAQ item updated successfully")}catch(s){l.error("Failed to update FAQ item")}finally{se(!1)}})(t),disabled:ee,children:ee?e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"mr-2 h-4 w-4"}),"Save"]})})})]},t.id)))})]})}),e.jsx(g,{value:"shipping",children:e.jsxs(x,{children:[e.jsxs(_,{children:[e.jsx(u,{children:"Shipping Information"}),e.jsx(C,{children:"Manage the content displayed on the shipping information page."})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"shipping_title_tr",children:"Title (Turkish)"}),e.jsx(A,{id:"shipping_title_tr",value:(null==G?void 0:G.title_tr)||"",onChange:e=>O((s=>s?{...s,title_tr:e.target.value}:{id:"",page_type:"shipping",title_tr:e.target.value,title_en:"",content_tr:"",content_en:"",is_active:!0}))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"shipping_title_en",children:"Title (English)"}),e.jsx(A,{id:"shipping_title_en",value:(null==G?void 0:G.title_en)||"",onChange:e=>O((s=>s?{...s,title_en:e.target.value}:{id:"",page_type:"shipping",title_tr:"",title_en:e.target.value,content_tr:"",content_en:"",is_active:!0}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"shipping_content_tr",children:"Content (Turkish)"}),e.jsx(T,{id:"shipping_content_tr",value:(null==G?void 0:G.content_tr)||"",onChange:e=>O((s=>s?{...s,content_tr:e.target.value}:{id:"",page_type:"shipping",title_tr:"",title_en:"",content_tr:e.target.value,content_en:"",is_active:!0})),className:"min-h-[300px]"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"HTML formatting is supported."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"shipping_content_en",children:"Content (English)"}),e.jsx(T,{id:"shipping_content_en",value:(null==G?void 0:G.content_en)||"",onChange:e=>O((s=>s?{...s,content_en:e.target.value}:{id:"",page_type:"shipping",title_tr:"",title_en:"",content_tr:"",content_en:e.target.value,is_active:!0})),className:"min-h-[300px]"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"HTML formatting is supported."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{id:"shipping_active",checked:(null==G?void 0:G.is_active)||!1,onCheckedChange:e=>O((s=>s?{...s,is_active:e}:{id:"",page_type:"shipping",title_tr:"",title_en:"",content_tr:"",content_en:"",is_active:e}))}),e.jsx(S,{htmlFor:"shipping_active",children:"Active"})]})]}),e.jsx(q,{children:e.jsx(v,{onClick:()=>de("shipping"),disabled:ee,className:"ml-auto",children:ee?e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"mr-2 h-4 w-4"}),"Save"]})})})]})}),e.jsx(g,{value:"returns",children:e.jsxs(x,{children:[e.jsxs(_,{children:[e.jsx(u,{children:"Returns & Refunds Policy"}),e.jsx(C,{children:"Manage the content displayed on the returns and refunds page."})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"returns_title_tr",children:"Title (Turkish)"}),e.jsx(A,{id:"returns_title_tr",value:(null==V?void 0:V.title_tr)||"",onChange:e=>B((s=>s?{...s,title_tr:e.target.value}:{id:"",page_type:"returns",title_tr:e.target.value,title_en:"",content_tr:"",content_en:"",is_active:!0}))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"returns_title_en",children:"Title (English)"}),e.jsx(A,{id:"returns_title_en",value:(null==V?void 0:V.title_en)||"",onChange:e=>B((s=>s?{...s,title_en:e.target.value}:{id:"",page_type:"returns",title_tr:"",title_en:e.target.value,content_tr:"",content_en:"",is_active:!0}))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"returns_content_tr",children:"Content (Turkish)"}),e.jsx(T,{id:"returns_content_tr",value:(null==V?void 0:V.content_tr)||"",onChange:e=>B((s=>s?{...s,content_tr:e.target.value}:{id:"",page_type:"returns",title_tr:"",title_en:"",content_tr:e.target.value,content_en:"",is_active:!0})),className:"min-h-[300px]"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"HTML formatting is supported."})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(S,{htmlFor:"returns_content_en",children:"Content (English)"}),e.jsx(T,{id:"returns_content_en",value:(null==V?void 0:V.content_en)||"",onChange:e=>B((s=>s?{...s,content_en:e.target.value}:{id:"",page_type:"returns",title_tr:"",title_en:"",content_tr:"",content_en:e.target.value,is_active:!0})),className:"min-h-[300px]"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"HTML formatting is supported."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{id:"returns_active",checked:(null==V?void 0:V.is_active)||!1,onCheckedChange:e=>B((s=>s?{...s,is_active:e}:{id:"",page_type:"returns",title_tr:"",title_en:"",content_tr:"",content_en:"",is_active:e}))}),e.jsx(S,{htmlFor:"returns_active",children:"Active"})]})]}),e.jsx(q,{children:e.jsx(v,{onClick:()=>de("returns"),disabled:ee,className:"ml-auto",children:ee?e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"mr-2 h-4 w-4"}),"Save"]})})})]})}),e.jsx(g,{value:"contact-settings",children:e.jsxs(x,{children:[e.jsxs(_,{children:[e.jsx(u,{children:"Contact Page Settings"}),e.jsx(C,{children:"Customize the contact page image and other settings"})]}),e.jsx(b,{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx(S,{htmlFor:"contact-image",children:"Contact Page Image"}),e.jsxs("div",{className:"mt-2 flex items-start space-x-4",children:[e.jsx("div",{className:"max-w-xs",children:K.contact_image_url?e.jsx("img",{src:K.contact_image_url,alt:"Contact page image",className:"rounded-md border border-gray-200 dark:border-gray-700 object-cover w-full max-h-60"}):e.jsx("div",{className:"rounded-md border border-gray-200 dark:border-gray-700 bg-gray-100 dark:bg-gray-800 w-full h-40 flex items-center justify-center",children:e.jsx(i,{className:"h-10 w-10 text-gray-400"})})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"image-upload",className:"cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2 p-2 border border-input rounded-md bg-background hover:bg-accent hover:text-accent-foreground",children:[e.jsx(r,{className:"h-4 w-4"}),e.jsx("span",{children:te?"Uploading...":"Upload Image"})]}),e.jsx("input",{id:"image-upload",type:"file",accept:"image/*",className:"sr-only",onChange:async e=>{var s;const t=null==(s=e.target.files)?void 0:s[0];if(t)try{ae(!0);const e=t.name.split(".").pop(),s=`contact/contact-image-${Date.now()}.${e}`,{data:a,error:n}=await c.storage.from("images").upload(s,t);if(n)throw n;const{data:{publicUrl:i}}=c.storage.from("images").getPublicUrl(s);W({...K,contact_image_url:i}),await he(i),l.success("Image uploaded successfully")}catch(a){l.error("Failed to upload image")}finally{ae(!1)}},disabled:te})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Recommended size: 950x700px. Maximum file size: 5MB."})]})]})]})}),e.jsx(q,{className:"justify-end",children:e.jsx(v,{onClick:()=>he(),disabled:ee||te,children:ee?e.jsxs(e.Fragment,{children:[e.jsx(s,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"mr-2 h-4 w-4"}),"Save Settings"]})})})]})}),e.jsx(g,{value:"contact-messages",children:e.jsxs(x,{children:[e.jsxs(_,{children:[e.jsx(u,{children:"Contact Messages"}),e.jsx(C,{children:"View and manage messages submitted through the contact form."})]}),e.jsx(b,{children:0===X.length?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No contact messages found."}):e.jsxs(M,{children:[e.jsx($,{children:e.jsxs(E,{children:[e.jsx(P,{children:"Date"}),e.jsx(P,{children:"Name"}),e.jsx(P,{children:"Email"}),e.jsx(P,{children:"Message"}),e.jsx(P,{children:"Status"}),e.jsx(P,{className:"text-right",children:"Actions"})]})}),e.jsx(D,{children:X.map((s=>e.jsxs(E,{className:s.read?"":"bg-muted/50",children:[e.jsx(R,{children:new Date(s.created_at).toLocaleDateString()}),e.jsx(R,{children:s.name}),e.jsx(R,{children:s.email}),e.jsx(R,{className:"max-w-[300px] truncate",children:s.message}),e.jsx(R,{children:e.jsx(v,{variant:"ghost",size:"sm",onClick:()=>oe(s.id,s.read),children:s.read?"Read":"Unread"})}),e.jsxs(R,{className:"text-right space-x-2",children:[e.jsx(v,{variant:"outline",size:"sm",onClick:()=>{z({title:"Message Details",description:e.jsxs("div",{className:"mt-2 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"From:"})," ",s.name," (",s.email,")"]}),s.phone&&e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," ",s.phone]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(s.created_at).toLocaleString()]}),e.jsx("p",{children:e.jsx("strong",{children:"Message:"})}),e.jsx("p",{className:"border p-2 rounded bg-muted",children:s.message})]})}),s.read||oe(s.id,!1)},children:"View"}),e.jsx(v,{variant:"destructive",size:"sm",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this message?"))try{const{error:s}=await c.from("contact_messages").delete().eq("id",e);if(s)throw s;J(X.filter((s=>s.id!==e))),l.success("Message deleted successfully")}catch(s){l.error("Failed to delete message")}})(s.id),children:"Delete"})]})]},s.id)))})]})})]})})]})]})};export{z as default};
