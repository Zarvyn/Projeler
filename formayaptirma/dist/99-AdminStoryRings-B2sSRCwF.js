import{c as e,j as r,a,P as t,d as s,e as i,aM as n,aO as l,l as o,aN as d,aP as c,D as u,g as m,f as p,Z as h,n as g,s as _,J as x,a7 as j,aF as y,I as f,aL as v,aS as k,aT as N,aG as w}from"./03-hero-critical-BKzCa96P.js";import{r as b}from"./01-react-core-DCvPBpDR.js";import{B as C,C as F,g as P,h as R,i as O,f as S,D,j as H,k as A,l as z,m as E,o as q}from"./04-ui-components-DpbmxBFV.js";import{d as I,A as T,C as G,e as M,R as B,I as Y,f as $,g as K,h as V}from"./05-admin-bundle-BW3OFzIa.js";import{L as U}from"./99-label-DtO75rKq.js";import{T as Z}from"./99-textarea-BOZk7JoE.js";import{S as L}from"./99-switch-BaDU39Q5.js";import{I as J}from"./99-image-uploader-KY2aE3Hk.js";import{M as X}from"./99-multi-image-uploader-BtQB02N5.js";import{T as Q,a as W,b as ee,c as re,d as ae,e as te}from"./99-table-DV3dN7kr.js";import{R as se,a as ie}from"./99-radio-group-D1t5BLDW.js";import{c as ne}from"./06-utils-QQqVvbBo.js";import{S as le,a as oe,b as de,c as ce,d as ue}from"./99-select-CL9TI2Dz.js";import"./02-react-router-l50u7dmW.js";import"./99-index-D5v_MFz8.js";import"./99-ensureBuckets-oAmkppU8.js";import"./99-badge-CpQK4qLU.js";import"./99-index-CxCer4qO.js";var me="Popover",[pe,he]=e(me,[I]),ge=I(),[_e,xe]=pe(me),je=e=>{const{__scopePopover:a,children:t,open:s,defaultOpen:i,onOpenChange:n,modal:l=!1}=e,o=ge(a),d=b.useRef(null),[c,u]=b.useState(!1),[h=!1,g]=m({prop:s,defaultProp:i,onChange:n});return r.jsx(B,{...o,children:r.jsx(_e,{scope:a,contentId:p(),triggerRef:d,open:h,onOpenChange:g,onOpenToggle:b.useCallback((()=>g((e=>!e))),[g]),hasCustomAnchor:c,onCustomAnchorAdd:b.useCallback((()=>u(!0)),[]),onCustomAnchorRemove:b.useCallback((()=>u(!1)),[]),modal:l,children:t})})};je.displayName=me;var ye="PopoverAnchor";b.forwardRef(((e,a)=>{const{__scopePopover:t,...s}=e,i=xe(ye,t),n=ge(t),{onCustomAnchorAdd:l,onCustomAnchorRemove:o}=i;return b.useEffect((()=>(l(),()=>o())),[l,o]),r.jsx(T,{...n,...s,ref:a})})).displayName=ye;var fe="PopoverTrigger",ve=b.forwardRef(((e,i)=>{const{__scopePopover:n,...l}=e,o=xe(fe,n),d=ge(n),c=a(i,o.triggerRef),u=r.jsx(t.button,{type:"button","aria-haspopup":"dialog","aria-expanded":o.open,"aria-controls":o.contentId,"data-state":De(o.open),...l,ref:c,onClick:s(e.onClick,o.onOpenToggle)});return o.hasCustomAnchor?u:r.jsx(T,{asChild:!0,...d,children:u})}));ve.displayName=fe;var ke="PopoverPortal",[Ne,we]=pe(ke,{forceMount:void 0}),be=e=>{const{__scopePopover:a,forceMount:t,children:s,container:n}=e,l=xe(ke,a);return r.jsx(Ne,{scope:a,forceMount:t,children:r.jsx(i,{present:t||l.open,children:r.jsx(h,{asChild:!0,container:n,children:s})})})};be.displayName=ke;var Ce="PopoverContent",Fe=b.forwardRef(((e,a)=>{const t=we(Ce,e.__scopePopover),{forceMount:s=t.forceMount,...n}=e,l=xe(Ce,e.__scopePopover);return r.jsx(i,{present:s||l.open,children:l.modal?r.jsx(Pe,{...n,ref:a}):r.jsx(Re,{...n,ref:a})})}));Fe.displayName=Ce;var Pe=b.forwardRef(((e,t)=>{const i=xe(Ce,e.__scopePopover),d=b.useRef(null),c=a(t,d),u=b.useRef(!1);return b.useEffect((()=>{const e=d.current;if(e)return n(e)}),[]),r.jsx(l,{as:o,allowPinchZoom:!0,children:r.jsx(Oe,{...e,ref:c,trapFocus:i.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:s(e.onCloseAutoFocus,(e=>{var r;e.preventDefault(),u.current||null==(r=i.triggerRef.current)||r.focus()})),onPointerDownOutside:s(e.onPointerDownOutside,(e=>{const r=e.detail.originalEvent,a=0===r.button&&!0===r.ctrlKey,t=2===r.button||a;u.current=t}),{checkForDefaultPrevented:!1}),onFocusOutside:s(e.onFocusOutside,(e=>e.preventDefault()),{checkForDefaultPrevented:!1})})})})),Re=b.forwardRef(((e,a)=>{const t=xe(Ce,e.__scopePopover),s=b.useRef(!1),i=b.useRef(!1);return r.jsx(Oe,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:r=>{var a,n;null==(a=e.onCloseAutoFocus)||a.call(e,r),r.defaultPrevented||(s.current||null==(n=t.triggerRef.current)||n.focus(),r.preventDefault()),s.current=!1,i.current=!1},onInteractOutside:r=>{var a,n;null==(a=e.onInteractOutside)||a.call(e,r),r.defaultPrevented||(s.current=!0,"pointerdown"===r.detail.originalEvent.type&&(i.current=!0));const l=r.target;(null==(n=t.triggerRef.current)?void 0:n.contains(l))&&r.preventDefault(),"focusin"===r.detail.originalEvent.type&&i.current&&r.preventDefault()}})})),Oe=b.forwardRef(((e,a)=>{const{__scopePopover:t,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:n,disableOutsidePointerEvents:l,onEscapeKeyDown:o,onPointerDownOutside:m,onFocusOutside:p,onInteractOutside:h,...g}=e,_=xe(Ce,t),x=ge(t);return d(),r.jsx(c,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:i,onUnmountAutoFocus:n,children:r.jsx(u,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:h,onEscapeKeyDown:o,onPointerDownOutside:m,onFocusOutside:p,onDismiss:()=>_.onOpenChange(!1),children:r.jsx(G,{"data-state":De(_.open),role:"dialog",id:_.contentId,...x,...g,ref:a,style:{...g.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})})),Se="PopoverClose";function De(e){return e?"open":"closed"}b.forwardRef(((e,a)=>{const{__scopePopover:i,...n}=e,l=xe(Se,i);return r.jsx(t.button,{type:"button",...n,ref:a,onClick:s(e.onClick,(()=>l.onOpenChange(!1)))})})).displayName=Se,b.forwardRef(((e,a)=>{const{__scopePopover:t,...s}=e,i=ge(t);return r.jsx(M,{...i,...s,ref:a})})).displayName="PopoverArrow";var He=be,Ae=Fe;const ze=je,Ee=ve,qe=b.forwardRef((({className:e,align:a="center",sideOffset:t=4,...s},i)=>r.jsx(He,{children:r.jsx(Ae,{ref:i,align:a,sideOffset:t,className:ne("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})})));qe.displayName=Ae.displayName;const Ie=[{id:"purple",value:"linear-gradient(45deg, #9b87f5, #7066ff)",name:"Mor Gradient"},{id:"blue",value:"linear-gradient(45deg, #68B3FF, #3452FF)",name:"Mavi Gradient"},{id:"green",value:"linear-gradient(45deg, #4CD2A2, #1F9A57)",name:"Yeşil Gradient"},{id:"red",value:"linear-gradient(45deg, #FF7868, #FF3434)",name:"Kırmızı Gradient"},{id:"orange",value:"linear-gradient(45deg, #FFB347, #FF6B00)",name:"Turuncu Gradient"},{id:"pink",value:"linear-gradient(45deg, #FF9ED2, #FF49B8)",name:"Pembe Gradient"},{id:"teal",value:"linear-gradient(45deg, #49E0FF, #00B8D4)",name:"Turkuaz Gradient"},{id:"yellow",value:"linear-gradient(45deg, #FFF176, #FFD600)",name:"Sarı Gradient"}],Te=[{id:"square",name:"Kare",icon:"square"},{id:"circle",name:"Yuvarlak",icon:"circle"},{id:"rounded",name:"Yuvarlatılmış",icon:"rounded-square"},{id:"star",name:"Yıldız",icon:"star"}],Ge=()=>{var e;const{t:a,language:t}=g(),[s,i]=b.useState([]),[n,l]=b.useState(!0),[o,d]=b.useState(!1),[c,u]=b.useState(null),[m,p]=b.useState([]),[h,I]=b.useState(!1),[T,G]=b.useState([]),[M,B]=b.useState({title_tr:"",title_en:"",content_tr:"",content_en:"",image_url:"",images:[],ring_color:"linear-gradient(45deg, #9b87f5, #7066ff)",shape:"square",jersey_type_id:null,is_active:!0,display_order:0});b.useEffect((()=>{me(),ne()}),[]);const ne=async()=>{try{const{data:e,error:r}=await _.from("jersey_types").select("*").eq("is_active",!0);if(r)throw r;G(e||[])}catch(e){x.error(a("error_fetching_jersey_types")||"Forma tipleri yüklenirken hata oluştu")}},me=async()=>{try{l(!0);const{data:e,error:r}=await _.from("story_rings").select("*").order("display_order",{ascending:!0});if(r)throw r;const a=(null==e?void 0:e.map((e=>({id:e.id,title:e.title,title_tr:e.title_tr,title_en:e.title_en,content:e.content,content_tr:e.content_tr,content_en:e.content_en,image_url:e.image_url,images:e.images||[],ring_color:e.ring_color,shape:e.shape,jersey_type_id:e.jersey_type_id,created_at:e.created_at,is_active:e.is_active,display_order:e.display_order}))))||[];i(a)}catch(e){x.error(a("error_fetching_stories")||"Hikayeler yüklenirken hata oluştu")}finally{l(!1)}},pe=async(e,r)=>{const t=s.findIndex((r=>r.id===e));if("up"===r&&0===t||"down"===r&&t===s.length-1)return;const n="up"===r?t-1:t+1,l=s[n];try{d(!0);const e=s[t],r=e.display_order,o=l.display_order;await _.from("story_rings").update({display_order:o}).eq("id",e.id),await _.from("story_rings").update({display_order:r}).eq("id",l.id);const c=[...s];[c[t],c[n]]=[c[n],c[t]],i(c),x.success(a("story_order_updated")||"Hikaye sırası güncellendi")}catch(o){x.error(a("error_updating_story_order")||"Hikaye sırası güncellenirken hata oluştu")}finally{d(!1)}},he=async e=>{if(c)try{d(!0);const{error:r}=await _.from("story_rings").update({ring_color:e}).eq("id",c.id);if(r)throw r;i(s.map((r=>r.id===c.id?{...r,ring_color:e}:r))),I(!1),u(null),x.success(a("color_updated")||"Renk güncellendi")}catch(r){x.error(a("error_updating_color")||"Renk güncellenirken hata oluştu")}finally{d(!1)}},ge=e=>{switch(e){case"circle":return"rounded-full";case"rounded":return"rounded-lg";case"star":return"story-star";default:return"rounded-none"}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h2",{className:"text-2xl font-bold",children:a("story_rings")||"Hikaye Halkası"}),r.jsxs(C,{onClick:me,variant:"outline",disabled:n,children:[n?r.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}):null,a("refresh")||"Yenile"]})]}),r.jsxs(F,{children:[r.jsxs(P,{children:[r.jsx(R,{children:a("add_new_story")||"Yeni Hikaye Ekle"}),r.jsx(O,{children:a("add_new_story_description")||"Anasayfada gösterilecek yeni bir hikaye halkası ekleyin."})]}),r.jsx(S,{children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[r.jsxs("div",{children:[r.jsx(U,{htmlFor:"title_tr",children:a("title_tr")||"Başlık (TR)"}),r.jsx(Y,{id:"title_tr",value:M.title_tr||"",onChange:e=>B({...M,title_tr:e.target.value})})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"title_en",children:a("title_en")||"Başlık (EN)"}),r.jsx(Y,{id:"title_en",value:M.title_en||"",onChange:e=>B({...M,title_en:e.target.value})})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"content_tr",children:a("content_tr")||"İçerik (TR)"}),r.jsx(Z,{id:"content_tr",value:M.content_tr||"",onChange:e=>B({...M,content_tr:e.target.value}),rows:3})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"content_en",children:a("content_en")||"İçerik (EN)"}),r.jsx(Z,{id:"content_en",value:M.content_en||"",onChange:e=>B({...M,content_en:e.target.value}),rows:3})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"jersey_type",children:a("jersey_type")||"Forma Tipi"}),r.jsxs(le,{value:null===M.jersey_type_id?"none":M.jersey_type_id,onValueChange:e=>B({...M,jersey_type_id:"none"===e?null:e}),children:[r.jsx(oe,{className:"w-full",children:r.jsx(de,{placeholder:a("select_jersey_type")||"Forma Tipi Seç"})}),r.jsxs(ce,{children:[r.jsx(ue,{value:"none",children:a("none_selected")||"Seçilmedi"}),T.map((e=>r.jsx(ue,{value:e.id,children:"tr"===t?e.name_tr:e.name},e.id)))]})]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("jersey_type_help")||"Bir forma tipi seçerseniz, hikayeye tıklandığında galeri sayfasına yönlendirilir ve seçilen forma tipi filtrelenir."})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"ring_color",children:a("ring_color")||"Halka Rengi"}),r.jsxs(ze,{children:[r.jsx(Ee,{asChild:!0,children:r.jsxs(C,{variant:"outline",className:"w-full justify-start text-left font-normal flex items-center gap-2",children:[r.jsx("div",{className:"w-6 h-6 rounded-full",style:{background:M.ring_color}}),r.jsx("span",{children:(null==(e=Ie.find((e=>e.value===M.ring_color)))?void 0:e.name)||a("select_color")||"Renk Seçin"})]})}),r.jsx(qe,{className:"w-80",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-medium",children:a("select_ring_color")||"Halka Rengi Seçin"}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:Ie.map((e=>r.jsx("button",{className:"w-12 h-12 rounded-full transition-all duration-200 "+(M.ring_color===e.value?"ring-2 ring-primary ring-offset-2":"ring-1 ring-gray-300"),style:{background:e.value},onClick:()=>B({...M,ring_color:e.value}),title:e.name},e.id)))}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"custom_color",children:a("custom_color")||"Özel Renk"}),r.jsx(Y,{id:"custom_color",value:M.ring_color,onChange:e=>B({...M,ring_color:e.target.value}),placeholder:"linear-gradient(45deg, #9b87f5, #7066ff)",className:"mt-2"})]})]})})]}),r.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:a("ring_color_help")||"CSS renk kodu veya gradient. Örn: #9b87f5 veya linear-gradient(45deg, #9b87f5, #7066ff)"})]}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"shape",children:a("shape")||"Şekil"}),r.jsx("div",{className:"grid grid-cols-4 gap-2 mt-2",children:Te.map((e=>r.jsxs("button",{className:"p-3 flex flex-col items-center justify-center border rounded-md transition-all duration-200 "+(M.shape===e.id?"bg-primary/10 border-primary":"border-gray-200 hover:bg-gray-100 dark:border-gray-700 dark:hover:bg-gray-800"),onClick:()=>B({...M,shape:e.id}),title:e.name,children:[r.jsx("div",{className:"w-8 h-8 "+("square"===e.id?"rounded-none":"circle"===e.id?"rounded-full":"rounded"===e.id?"rounded-lg":"story-star"),style:{background:"currentColor"}}),r.jsx("span",{className:"text-xs mt-1",children:e.name})]},e.id)))})]})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(U,{children:a("story_image")||"Hikaye Görseli"}),r.jsx("div",{className:"mt-2",children:r.jsx(J,{currentImageUrl:M.image_url||"",onImageUploaded:e=>B({...M,image_url:e}),bucketName:"story_images"})})]}),r.jsxs("div",{className:"flex flex-col items-center justify-center mt-6",children:[r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"p-[2px] rounded-full",style:{background:M.ring_color||"linear-gradient(45deg, #9b87f5, #7066ff)"},children:r.jsxs($,{className:"h-24 w-24 border-2 border-white dark:border-gray-800",children:[r.jsx(K,{src:M.image_url||"",alt:"tr"===t?M.title_tr||"Yeni Hikaye":M.title_en||"New Story"}),r.jsx(V,{className:"bg-primary/10 text-primary",children:"tr"===t?M.title_tr||"YH":M.title_en||"NS"})]})}),r.jsx("span",{className:"text-sm mt-2",children:"tr"===t?M.title_tr||"Yeni Hikaye":M.title_en||"New Story"})]}),r.jsxs(C,{className:"mt-4 w-full",onClick:async()=>{try{d(!0);const e=s.length>0?Math.max(...s.map((e=>e.display_order||0))):-1;if(!M.image_url)return x.error(a("image_required")||"Resim gereklidir"),void d(!1);const r={...M,title:M.title_tr||M.title_en||"Story",display_order:e+1,is_active:!0,image_url:M.image_url,images:M.images||[],shape:M.shape,jersey_type_id:M.jersey_type_id},{data:t,error:n}=await _.from("story_rings").insert(r).select().single();if(n)throw n;x.success(a("story_added")||"Hikaye eklendi");const l={id:t.id,title:t.title,title_tr:t.title_tr,title_en:t.title_en,content:t.content,content_tr:t.content_tr,content_en:t.content_en,image_url:t.image_url,images:t.images||[],ring_color:t.ring_color,shape:t.shape||"square",jersey_type_id:t.jersey_type_id,created_at:t.created_at,is_active:t.is_active,display_order:t.display_order};i([...s,l]),B({title_tr:"",title_en:"",content_tr:"",content_en:"",image_url:"",images:[],ring_color:"linear-gradient(45deg, #9b87f5, #7066ff)",shape:"square",jersey_type_id:null,is_active:!0,display_order:0})}catch(e){x.error(a("error_adding_story")||"Hikaye eklenirken hata oluştu")}finally{d(!1)}},disabled:o||!M.image_url||!(M.title_tr||M.title_en),children:[o?r.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}):r.jsx(y,{className:"mr-2 h-4 w-4"}),a("add_story")||"Hikaye Ekle"]})]})]})]})})]}),r.jsxs(F,{children:[r.jsxs(P,{children:[r.jsx(R,{children:a("existing_stories")||"Mevcut Hikayeler"}),r.jsx(O,{children:a("manage_stories")||"Mevcut hikayeleri yönetin ve düzenleyin."})]}),r.jsx(S,{children:n?r.jsx("div",{className:"flex justify-center py-8",children:r.jsx(j,{className:"h-8 w-8 animate-spin text-primary"})}):0===s.length?r.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a("no_stories")||"Henüz hikaye bulunmamaktadır."}):r.jsxs(Q,{children:[r.jsx(W,{children:r.jsxs(ee,{children:[r.jsx(re,{className:"w-[80px]",children:a("preview")||"Önizleme"}),r.jsx(re,{children:a("title")||"Başlık"}),r.jsx(re,{className:"hidden md:table-cell",children:a("content")||"İçerik"}),r.jsx(re,{className:"w-[150px]",children:a("jersey_type")||"Forma Tipi"}),r.jsx(re,{className:"w-[100px] text-center",children:a("status")||"Durum"}),r.jsx(re,{className:"w-[340px] text-right",children:a("actions")||"İşlemler"})]})}),r.jsx(ae,{children:s.map((e=>r.jsxs(ee,{children:[r.jsxs(te,{children:[r.jsx("div",{className:`p-[2px] ${ge(e.shape)} ${e.is_active?"":"opacity-50"}`,style:{background:e.ring_color||"linear-gradient(45deg, #9b87f5, #7066ff)"},children:r.jsx("div",{className:`h-12 w-12 border-2 border-white dark:border-gray-800 overflow-hidden ${ge(e.shape)}`,children:r.jsx("img",{src:e.image_url,alt:"tr"===t?e.title_tr||e.title:e.title_en||e.title,className:"w-full h-full object-cover"})})}),r.jsx("div",{className:"text-xs text-center mt-1",children:e.images&&e.images.length>0&&r.jsxs("span",{className:"text-muted-foreground",children:["+",e.images.length]})})]}),r.jsxs(te,{children:[r.jsx("div",{className:"font-medium",children:"tr"===t?e.title_tr||e.title:e.title_en||e.title}),r.jsxs("div",{className:"text-xs text-muted-foreground",children:["en"===t&&e.title_tr?`TR: ${e.title_tr}`:"","tr"===t&&e.title_en?`EN: ${e.title_en}`:""]})]}),r.jsx(te,{className:"hidden md:table-cell",children:r.jsx("div",{className:"text-sm truncate max-w-[300px]",children:"tr"===t?e.content_tr||e.content||"":e.content_en||e.content||""})}),r.jsx(te,{children:r.jsxs(le,{value:null===e.jersey_type_id?"none":e.jersey_type_id,onValueChange:r=>(async(e,r)=>{try{d(!0);const{error:t}=await _.from("story_rings").update({jersey_type_id:r}).eq("id",e);if(t)throw t;i(s.map((a=>a.id===e?{...a,jersey_type_id:r}:a))),x.success(a("jersey_type_updated")||"Forma tipi güncellendi")}catch(t){x.error(a("error_updating_jersey_type")||"Forma tipi güncellenirken hata oluştu")}finally{d(!1)}})(e.id,"none"===r?null:r),children:[r.jsx(oe,{className:"w-full",children:r.jsx(de,{placeholder:a("select_jersey_type")||"Forma Tipi Seç"})}),r.jsxs(ce,{children:[r.jsx(ue,{value:"none",children:a("none_selected")||"Seçilmedi"}),T.map((e=>r.jsx(ue,{value:e.id,children:"tr"===t?e.name_tr:e.name},e.id)))]})]})}),r.jsx(te,{className:"text-center",children:r.jsx(L,{checked:e.is_active,onCheckedChange:r=>(async(e,r)=>{try{d(!0);const{error:t}=await _.from("story_rings").update(r).eq("id",e);if(t)throw t;i(s.map((a=>a.id===e?{...a,...r}:a))),x.success(a("story_updated")||"Hikaye güncellendi")}catch(t){x.error(a("error_updating_story")||"Hikaye güncellenirken hata oluştu")}finally{d(!1)}})(e.id,{is_active:r})})}),r.jsx(te,{className:"text-right",children:r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(C,{variant:"outline",size:"icon",onClick:()=>(e=>{u(e),I(!0)})(e),title:a("change_color")||"Renk Değiştir",style:{background:"linear-gradient(135deg, #f5f5f5, #fff)"},children:r.jsx("div",{className:"h-4 w-4 rounded-full",style:{background:e.ring_color}})}),r.jsxs(ze,{children:[r.jsx(Ee,{asChild:!0,children:r.jsx(C,{variant:"outline",size:"icon",title:a("change_shape")||"Şekil Değiştir",children:r.jsx("div",{className:`h-4 w-4 ${ge(e.shape)}`,style:{background:"currentColor"}})})}),r.jsx(qe,{className:"w-60",children:r.jsxs("div",{className:"space-y-2",children:[r.jsx("h4",{className:"font-medium",children:a("select_shape")||"Şekil Seçin"}),r.jsx("div",{className:"grid grid-cols-4 gap-2",children:Te.map((t=>r.jsxs("button",{className:"p-2 flex flex-col items-center justify-center border rounded-md transition-all duration-200 "+(e.shape===t.id?"bg-primary/10 border-primary":"border-gray-200 hover:bg-gray-100 dark:border-gray-700 dark:hover:bg-gray-800"),onClick:()=>(async(e,r)=>{try{d(!0);const{error:t}=await _.from("story_rings").update({shape:r}).eq("id",e);if(t)throw t;i(s.map((a=>a.id===e?{...a,shape:r}:a))),x.success(a("shape_updated")||"Şekil güncellendi")}catch(t){x.error(a("error_updating_shape")||"Şekil güncellenirken hata oluştu")}finally{d(!1)}})(e.id,t.id),title:t.name,children:[r.jsx("div",{className:"w-6 h-6 "+("square"===t.id?"rounded-none":"circle"===t.id?"rounded-full":"rounded"===t.id?"rounded-lg":"story-star"),style:{background:"currentColor"}}),r.jsx("span",{className:"text-xs mt-1",children:t.name})]},t.id)))})]})})]}),r.jsx(C,{variant:"outline",size:"icon",onClick:()=>(e=>{u(e),p(e.images||[])})(e),title:a("manage_images")||"Görselleri Yönet",children:r.jsx(f,{className:"h-4 w-4"})}),e.jersey_type_id&&r.jsx(C,{variant:"outline",size:"icon",className:e.jersey_type_id?"text-primary":"text-muted-foreground",title:a("has_jersey_type_link")||"Forma Tipine Bağlantı Var",disabled:!0,children:r.jsx(v,{className:"h-4 w-4"})}),r.jsx(C,{variant:"outline",size:"icon",onClick:()=>pe(e.id,"up"),disabled:0===s.findIndex((r=>r.id===e.id)),children:r.jsx(k,{className:"h-4 w-4"})}),r.jsx(C,{variant:"outline",size:"icon",onClick:()=>pe(e.id,"down"),disabled:s.findIndex((r=>r.id===e.id))===s.length-1,children:r.jsx(N,{className:"h-4 w-4"})}),r.jsx(C,{variant:"destructive",size:"icon",onClick:()=>(async e=>{try{d(!0);const{error:r}=await _.from("story_rings").delete().eq("id",e);if(r)throw r;i(s.filter((r=>r.id!==e))),x.success(a("story_deleted")||"Hikaye silindi")}catch(r){x.error(a("error_deleting_story")||"Hikaye silinirken hata oluştu")}finally{d(!1)}})(e.id),children:r.jsx(w,{className:"h-4 w-4"})})]})})]},e.id)))})]})})]}),r.jsx(D,{open:!!c&&!h,onOpenChange:e=>!e&&u(null),children:r.jsxs(H,{className:"sm:max-w-[80vw] max-h-[90vh] overflow-y-auto",children:[r.jsxs(A,{children:[r.jsxs(z,{children:[a("manage_images")||"Görselleri Yönet"," - ",c?"tr"===t?c.title_tr||c.title:c.title_en||c.title:""]}),r.jsx(E,{children:a("manage_images_description")||"Hikaye için ek görseller ekleyin veya düzenleyin."})]}),r.jsx("div",{className:"py-4",children:r.jsx(X,{currentImages:m,onImagesUpdated:p,bucketName:"story_images",folderPath:`stories/${(null==c?void 0:c.id)||"temp"}`})}),r.jsx(q,{children:r.jsxs(C,{onClick:async()=>{if(c)try{d(!0);const{error:e}=await _.from("story_rings").update({images:m}).eq("id",c.id);if(e)throw e;i(s.map((e=>e.id===c.id?{...e,images:m}:e))),u(null),x.success(a("images_updated")||"Görseller güncellendi")}catch(e){x.error(a("error_updating_images")||"Görseller güncellenirken hata oluştu")}finally{d(!1)}},disabled:o,children:[o?r.jsx(j,{className:"mr-2 h-4 w-4 animate-spin"}):null,a("save_images")||"Görselleri Kaydet"]})})]})}),r.jsx(D,{open:h,onOpenChange:e=>{e||(I(!1),u(null))},children:r.jsxs(H,{className:"sm:max-w-[425px]",children:[r.jsxs(A,{children:[r.jsx(z,{children:a("select_ring_color")||"Halka Rengi Seçin"}),r.jsx(E,{children:c?"tr"===t?c.title_tr||c.title:c.title_en||c.title:""})]}),r.jsx("div",{className:"py-4",children:r.jsxs("div",{className:"space-y-4",children:[r.jsx(se,{defaultValue:null==c?void 0:c.ring_color,className:"grid grid-cols-2 gap-2",children:Ie.map((e=>r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(ie,{value:e.value,id:e.id,className:"peer sr-only",onClick:()=>he(e.value)}),r.jsxs(U,{htmlFor:e.id,className:"flex items-center justify-center gap-2 rounded-md border-2 border-muted bg-popover p-4 hover:bg-accent hover:text-accent-foreground peer-data-[state=checked]:border-primary [&:has([data-state=checked])]:border-primary cursor-pointer w-full",children:[r.jsx("div",{className:"w-6 h-6 rounded-full",style:{background:e.value}}),r.jsx("span",{children:e.name})]})]},e.id)))}),r.jsxs("div",{children:[r.jsx(U,{htmlFor:"custom_color_input",children:a("custom_color")||"Özel Renk"}),r.jsx("div",{className:"flex gap-2 mt-2",children:r.jsx(Y,{id:"custom_color_input",placeholder:"linear-gradient(45deg, #9b87f5, #7066ff)",defaultValue:null==c?void 0:c.ring_color,onBlur:e=>{e.target.value&&he(e.target.value)}})})]})]})}),r.jsx(q,{children:r.jsx(C,{variant:"outline",onClick:()=>{I(!1),u(null)},children:a("cancel")||"İptal"})})]})})]})};export{Ge as default};
