var e=Object.defineProperty,t=(t,s,r)=>((t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r)(t,"symbol"!=typeof s?s+"":s,r);import{j as s}from"./03-hero-critical-BKzCa96P.js";import{r}from"./01-react-core-DCvPBpDR.js";import"./02-react-router-l50u7dmW.js";import"./06-utils-QQqVvbBo.js";const i={lcp:2500,fid:100,cls:.1,fcp:1800,ttfb:600},a=new class{constructor(){t(this,"violations",[])}checkMetric(e,t){const s=i[e],r=t<=s;return r||(this.violations.push({metric:e,value:t,budget:s,timestamp:Date.now()}),"undefined"!=typeof window&&"gtag"in window&&window.gtag("event","performance_budget_violation",{custom_parameter:e,value:Math.round(t)})),r}getSeverity(e,t){return t>{lcp:4e3,fid:300,cls:.25,fcp:3e3,ttfb:1500}[e]?"critical":"warning"}getViolations(){return this.violations}generateReport(){0!==this.violations.length&&this.violations.forEach((e=>{}))}reset(){this.violations=[]}},n=class e{constructor(){t(this,"metrics",{}),t(this,"observers",[]),t(this,"startTime",performance.now()),t(this,"initialized",!1)}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){this.initialized||(this.initialized=!0,this.initializeObservers(),this.trackNavigationTiming())}trackNavigationTiming(){"performance"in window&&"navigation"in performance&&window.addEventListener("load",(()=>{setTimeout((()=>{const e=performance.getEntriesByType("navigation")[0];e&&(this.metrics.domContentLoaded=e.domContentLoadedEventEnd-e.fetchStart,this.metrics.loadComplete=e.loadEventEnd-e.fetchStart,this.metrics.firstByte=e.responseStart-e.fetchStart,a.checkMetric("ttfb",this.metrics.firstByte),setTimeout((()=>{a.generateReport()}),5e3))}),0)}))}initializeObservers(){if("PerformanceObserver"in window){try{const e=new PerformanceObserver((e=>{const t=e.getEntries(),s=t[t.length-1];this.metrics.lcp=s.startTime,a.checkMetric("lcp",s.startTime),((22700-s.startTime)/22700*100).toFixed(1)}));e.observe({entryTypes:["largest-contentful-paint"]}),this.observers.push(e)}catch(e){}try{const e=new PerformanceObserver((e=>{e.getEntries().forEach((e=>{const t=e.processingStart-e.startTime;this.metrics.fid=t,a.checkMetric("fid",t)}))}));e.observe({entryTypes:["first-input"]}),this.observers.push(e)}catch(e){}try{let e=0;const t=new PerformanceObserver((t=>{t.getEntries().forEach((t=>{t.hadRecentInput||(e+=t.value,this.metrics.cls=e,a.checkMetric("cls",e))}))}));t.observe({entryTypes:["layout-shift"]}),this.observers.push(t)}catch(e){}}}mark(e){"performance"in window&&"mark"in performance&&performance.mark(e)}measure(e,t,s){if("performance"in window&&"measure"in performance)try{performance.measure(e,t,s);const r=performance.getEntriesByName(e)[0];return this.metrics[e]=r.duration,r.duration}catch(r){}return 0}getMetrics(){return{...this.metrics}}cleanup(){this.observers.forEach((e=>e.disconnect())),this.observers=[]}};t(n,"instance");const c=n.getInstance(),o=()=>{const[e,t]=r.useState({}),[n,o]=r.useState([]),[d,l]=r.useState(!1);r.useEffect((()=>{const e=()=>{const e=c.getMetrics(),s=a.getViolations();t(e),o(s)},s=setInterval(e,2e3);return e(),()=>clearInterval(s)}),[]);const m=(e,t)=>void 0===e?"loading":e<=t?"good":"poor",h=(e,t="ms")=>void 0===e?"---":"ms"===t?`${Math.round(e)}ms`:e.toFixed(4),x=e=>{switch(e){case"good":return"text-green-600 bg-green-50";case"poor":return"text-red-600 bg-red-50";default:return"text-gray-600 bg-gray-50"}};return window.location.search.includes("perf=true")?s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>l(!d),className:"fixed bottom-4 right-4 z-50 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition-colors",title:"Performance Dashboard",children:"📊"}),d&&s.jsxs("div",{className:"fixed bottom-20 right-4 z-50 bg-white border border-gray-200 rounded-lg shadow-xl p-4 w-80 max-h-96 overflow-y-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Performance Metrics"}),s.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[s.jsx("div",{className:"font-medium text-gray-700",children:"Metric"}),s.jsx("div",{className:"font-medium text-gray-700",children:"Value"}),s.jsx("div",{className:"font-medium text-gray-700",children:"Budget"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsx("div",{className:"font-medium",children:"LCP"}),s.jsx("div",{className:`px-2 py-1 rounded text-xs ${x(m(e.lcp,i.lcp))}`,children:h(e.lcp)}),s.jsxs("div",{className:"text-gray-500 text-xs",children:[i.lcp,"ms"]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsx("div",{className:"font-medium",children:"FID"}),s.jsx("div",{className:`px-2 py-1 rounded text-xs ${x(m(e.fid,i.fid))}`,children:h(e.fid)}),s.jsxs("div",{className:"text-gray-500 text-xs",children:[i.fid,"ms"]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsx("div",{className:"font-medium",children:"CLS"}),s.jsx("div",{className:`px-2 py-1 rounded text-xs ${x(m(e.cls,i.cls))}`,children:h(e.cls,"")}),s.jsx("div",{className:"text-gray-500 text-xs",children:i.cls})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[s.jsx("div",{className:"font-medium",children:"TTFB"}),s.jsx("div",{className:`px-2 py-1 rounded text-xs ${x(m(e.firstByte,i.ttfb))}`,children:h(e.firstByte)}),s.jsxs("div",{className:"text-gray-500 text-xs",children:[i.ttfb,"ms"]})]})]}),(e.domContentLoaded||e.loadComplete)&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2 text-sm",children:"Loading Times"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[e.domContentLoaded&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"DOM Ready:"}),s.jsx("span",{className:"font-mono",children:h(e.domContentLoaded)})]}),e.loadComplete&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Load Complete:"}),s.jsx("span",{className:"font-mono",children:h(e.loadComplete)})]})]})]}),n.length>0&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[s.jsx("h4",{className:"font-medium text-red-700 mb-2 text-sm",children:"⚠️ Budget Violations"}),s.jsx("div",{className:"space-y-1",children:n.slice(-3).map(((e,t)=>s.jsxs("div",{className:"text-xs text-red-600 bg-red-50 p-2 rounded",children:[s.jsx("div",{className:"font-medium",children:e.metric.toUpperCase()}),s.jsxs("div",{children:[h(e.value)," (budget: ",h(e.budget),")"]})]},t)))})]}),e.lcp&&s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"text-xs text-green-600 bg-green-50 p-2 rounded",children:[s.jsx("div",{className:"font-medium",children:"🎉 LCP Improvement"}),s.jsxs("div",{children:[((22700-e.lcp)/22700*100).toFixed(1),"% vs baseline"]})]})})]})]}):null};export{o as default};
