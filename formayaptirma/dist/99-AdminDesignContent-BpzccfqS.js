import{n as e,s,j as r,aR as t,aF as i,a7 as n,aG as l,J as a}from"./03-hero-critical-BKzCa96P.js";import{r as c}from"./01-react-core-DCvPBpDR.js";import{C as d,g as o,h as m,B as u,f as p,i as x,D as h,j as _,k as j,l as g,m as f,o as y}from"./04-ui-components-DpbmxBFV.js";import{u as v,I as b}from"./05-admin-bundle-BW3OFzIa.js";import{T as N,a as w,b as k,c as T}from"./99-tabs-CCs0hPp1.js";import{S}from"./99-switch-BaDU39Q5.js";import{T as C}from"./99-textarea-BOZk7JoE.js";import{F as q,a as R,b as z,c as D,d as E,f as O}from"./99-form-BQypkM9v.js";import{z as V,t as F}from"./99-zod-D0J4YnXH.js";import{u as G}from"./99-index.esm-2mfLcUez.js";import"./02-react-router-l50u7dmW.js";import"./06-utils-QQqVvbBo.js";import"./99-index-CxCer4qO.js";import"./99-index-D5v_MFz8.js";import"./99-label-DtO75rKq.js";const U=V.object({id:V.string().optional(),section:V.string(),title_en:V.string().min(1,{message:"Title (EN) is required"}),title_tr:V.string().min(1,{message:"Title (TR) is required"}),description_en:V.string().min(1,{message:"Description (EN) is required"}),description_tr:V.string().min(1,{message:"Description (TR) is required"})}),K=V.object({id:V.string().optional(),name:V.string().min(1,{message:"Template name is required"}),name_tr:V.string().min(1,{message:"Template name (TR) is required"}),type:V.string().min(1,{message:"Template type is required"}),model_url:V.string().optional(),texture_url:V.string().optional(),preview_url:V.string().min(1,{message:"Preview image URL is required"}),is_active:V.boolean(),display_order:V.number()}),L=()=>{const{t:V,language:L}=e(),[P,B]=c.useState("content"),[$,H]=c.useState(null),[M,A]=c.useState(!0),[I,J]=c.useState(!1),{templates:Q,loading:X,error:W,refreshTemplates:Y}=(()=>{const[r,t]=c.useState([]),[i,n]=c.useState(!0),[l,a]=c.useState(null),{toast:d}=v(),{t:o}=e(),m=async()=>{try{n(!0),a(null);const{data:e,error:r}=await s.from("design_templates").select("*").order("display_order",{ascending:!0});if(r)throw new Error(r.message);t(e||[])}catch(e){a(e instanceof Error?e:new Error(String(e))),d({title:o("error")||"Error",description:o("error_fetching_templates")||"Error fetching design templates",variant:"destructive"})}finally{n(!1)}};return c.useEffect((()=>{m()}),[o]),{templates:r,loading:i,error:l,refreshTemplates:m}})(),[Z,ee]=c.useState(!1),[se,re]=c.useState(null),[te,ie]=c.useState([]),[ne,le]=c.useState([]),[ae,ce]=c.useState([]),[de,oe]=c.useState(!0),me=G({resolver:F(U),defaultValues:{section:"design",title_en:"",title_tr:"",description_en:"",description_tr:""}}),ue=G({resolver:F(K),defaultValues:{name:"",name_tr:"",type:"2d",preview_url:"",is_active:!0,display_order:0}});c.useEffect((()=>{(async()=>{A(!0);try{const{data:e,error:r}=await s.from("homepage_content").select("*").eq("section","design").single();if(r&&"PGRST116"!==r.code)throw r;e&&H(e)}catch(e){a.error(V("error_fetching_content")||"İçerik yüklenirken hata oluştu")}finally{A(!1)}})()}),[V]),c.useEffect((()=>{(async()=>{oe(!0);try{const{data:e,error:r}=await s.from("design_options").select("*").eq("type","color").order("display_order",{ascending:!0});if(r)throw r;ie(e||[]);const{data:t,error:i}=await s.from("design_options").select("*").eq("type","fabric").order("display_order",{ascending:!0});if(i)throw i;le(t||[]);const{data:n,error:l}=await s.from("design_options").select("*").eq("type","font").order("display_order",{ascending:!0});if(l)throw l;ce(n||[])}catch(e){a.error(V("error_fetching_options")||"Seçenekler yüklenirken hata oluştu")}finally{oe(!1)}})()}),[V]);const pe=()=>{$?me.reset({id:$.id,section:$.section,title_en:$.title_en,title_tr:$.title_tr,description_en:$.description_en,description_tr:$.description_tr}):me.reset({section:"design",title_en:"",title_tr:"",description_en:"",description_tr:""}),J(!0)},xe=e=>{if(e){const s=Q.find((s=>s.id===e));s&&(ue.reset({id:s.id,name:s.name,name_tr:s.name_tr,type:s.type,model_url:s.model_url,texture_url:s.texture_url,preview_url:s.preview_url,is_active:s.is_active,display_order:s.display_order}),re(e))}else ue.reset({name:"",name_tr:"",type:"2d",preview_url:"",is_active:!0,display_order:Q.length+1}),re(null);ee(!0)};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs(N,{defaultValue:P,onValueChange:B,children:[r.jsxs(w,{className:"grid grid-cols-3 w-full mb-6",children:[r.jsx(k,{value:"content",children:V("page_content")||"Sayfa İçeriği"}),r.jsx(k,{value:"templates",children:V("design_templates")||"Tasarım Şablonları"}),r.jsx(k,{value:"options",children:V("design_options")||"Tasarım Seçenekleri"})]}),r.jsx(T,{value:"content",children:r.jsxs(d,{children:[r.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(m,{children:V("design_page_content")||"Tasarım Sayfası İçeriği"}),r.jsxs(u,{variant:"outline",size:"sm",onClick:pe,children:[$?r.jsx(t,{className:"mr-2 h-4 w-4"}):r.jsx(i,{className:"mr-2 h-4 w-4"}),$?V("edit_content")||"Düzenle":V("create_content")||"Oluştur"]})]}),r.jsx(p,{children:M?r.jsx("div",{className:"flex items-center justify-center h-40",children:r.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):$?r.jsx("div",{className:"space-y-4",children:r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-medium",children:"en"===L?$.title_en:$.title_tr}),r.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"en"===L?$.description_en:$.description_tr})]})}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-muted-foreground",children:V("no_content_yet")||"Henüz içerik bulunmuyor"}),r.jsxs(u,{variant:"outline",className:"mt-4",onClick:pe,children:[r.jsx(i,{className:"mr-2 h-4 w-4"}),V("create_content")||"İçerik Oluştur"]})]})})]})}),r.jsx(T,{value:"templates",children:r.jsxs(d,{children:[r.jsxs(o,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsxs("div",{children:[r.jsx(m,{children:V("design_templates")||"Tasarım Şablonları"}),r.jsx(x,{children:V("design_templates_description")||"2D ve 3D tasarımlar için şablonları yönetin"})]}),r.jsxs(u,{size:"sm",onClick:()=>xe(),children:[r.jsx(i,{className:"mr-2 h-4 w-4"}),V("add_template")||"Şablon Ekle"]})]}),r.jsx(p,{children:X?r.jsx("div",{className:"flex items-center justify-center h-40",children:r.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):Q.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Q.map((e=>r.jsxs(d,{className:"overflow-hidden "+(e.is_active?"":"opacity-70"),children:[r.jsxs("div",{className:"relative h-32 overflow-hidden bg-gray-100 dark:bg-gray-800",children:[e.preview_url&&r.jsx("img",{src:e.preview_url,alt:e.name,className:"w-full h-full object-cover"}),r.jsxs("div",{className:"absolute top-2 right-2 space-x-1",children:[r.jsx(u,{size:"icon",variant:"secondary",onClick:()=>xe(e.id),children:r.jsx(t,{className:"h-4 w-4"})}),r.jsx(u,{size:"icon",variant:"destructive",onClick:()=>(async e=>{if(window.confirm(V("confirm_delete_template")||"Bu şablonu silmek istediğinizden emin misiniz?"))try{const{error:r}=await s.from("design_templates").delete().eq("id",e);if(r)throw r;a.success(V("template_deleted_successfully")||"Şablon başarıyla silindi"),Y()}catch(r){a.error(V("error_deleting_template")||"Şablon silinirken hata oluştu")}})(e.id),children:r.jsx(l,{className:"h-4 w-4"})})]}),r.jsx("div",{className:"absolute bottom-2 left-2 bg-background/90 rounded-full px-2 py-1 text-xs",children:e.type.toUpperCase()})]}),r.jsxs("div",{className:"p-4 flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium truncate",children:"en"===L?e.name:e.name_tr}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:[V("display_order"),": ",e.display_order]})]}),r.jsx("div",{className:"flex items-center",children:r.jsx(S,{checked:e.is_active,onCheckedChange:()=>(async(e,r)=>{try{const{error:t}=await s.from("design_templates").update({is_active:!r}).eq("id",e);if(t)throw t;a.success(r?V("template_deactivated_successfully")||"Şablon başarıyla devre dışı bırakıldı":V("template_activated_successfully")||"Şablon başarıyla etkinleştirildi"),Y()}catch(t){a.error(V("error_updating_template")||"Şablon güncellenirken hata oluştu")}})(e.id,e.is_active)})})]})]},e.id)))}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-muted-foreground",children:V("no_templates_yet")||"Henüz şablon bulunmuyor"}),r.jsxs(u,{variant:"outline",className:"mt-4",onClick:()=>xe(),children:[r.jsx(i,{className:"mr-2 h-4 w-4"}),V("add_template")||"Şablon Ekle"]})]})})]})}),r.jsx(T,{value:"options",children:r.jsxs(d,{children:[r.jsxs(o,{children:[r.jsx(m,{children:V("design_options_summary")||"Tasarım Seçenekleri Özeti"}),r.jsx(x,{children:V("options_managed_separately")||"Bu seçenekler 'Tasarım' bölümünde yönetilir"})]}),r.jsx(p,{children:de?r.jsx("div",{className:"flex items-center justify-center h-40",children:r.jsx(n,{className:"h-8 w-8 animate-spin text-primary"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium mb-2",children:V("color_options")||"Renk Seçenekleri"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-2",children:[te.length>0?te.filter((e=>e.is_active)).slice(0,6).map((e=>r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("div",{className:"w-8 h-8 rounded-full border",style:{backgroundColor:e.value}}),r.jsx("span",{className:"text-xs mt-1",children:"tr"===L?e.name_tr:e.name})]},e.id))):r.jsx("p",{className:"text-sm text-muted-foreground col-span-full",children:V("no_color_options")||"Renk seçeneği bulunmuyor"}),te.length>6&&r.jsx("p",{className:"text-sm text-muted-foreground col-span-full mt-2",children:V("and_more_options",{count:te.length-6})||`Ve ${te.length-6} adet daha...`})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium mb-2",children:V("fabric_options")||"Kumaş Seçenekleri"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[ne.length>0?ne.filter((e=>e.is_active)).slice(0,6).map((e=>r.jsx("div",{className:"bg-secondary/30 rounded-md px-3 py-1",children:r.jsx("span",{className:"text-sm",children:"tr"===L?e.name_tr:e.name})},e.id))):r.jsx("p",{className:"text-sm text-muted-foreground col-span-full",children:V("no_fabric_options")||"Kumaş seçeneği bulunmuyor"}),ne.length>6&&r.jsx("p",{className:"text-sm text-muted-foreground col-span-full mt-2",children:V("and_more_options",{count:ne.length-6})||`Ve ${ne.length-6} adet daha...`})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium mb-2",children:V("font_options")||"Font Seçenekleri"}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[ae.length>0?ae.filter((e=>e.is_active)).slice(0,6).map((e=>r.jsx("div",{className:"bg-secondary/30 rounded-md px-3 py-1",children:r.jsx("span",{className:"text-sm",style:{fontFamily:e.value},children:"tr"===L?e.name_tr:e.name})},e.id))):r.jsx("p",{className:"text-sm text-muted-foreground col-span-full",children:V("no_font_options")||"Font seçeneği bulunmuyor"}),ae.length>6&&r.jsx("p",{className:"text-sm text-muted-foreground col-span-full mt-2",children:V("and_more_options",{count:ae.length-6})||`Ve ${ae.length-6} adet daha...`})]})]})]})})]})})]}),r.jsx(h,{open:I,onOpenChange:J,children:r.jsxs(_,{className:"sm:max-w-[600px]",children:[r.jsxs(j,{children:[r.jsx(g,{children:$?V("edit_design_content")||"Tasarım İçeriğini Düzenle":V("create_design_content")||"Tasarım İçeriği Oluştur"}),r.jsx(f,{children:V("design_content_instructions")||"Tasarım sayfasının içeriğini düzenleyin"})]}),r.jsx(q,{...me,children:r.jsxs("form",{onSubmit:me.handleSubmit((async e=>{try{if(e.id){const{error:r}=await s.from("homepage_content").update({title_en:e.title_en,title_tr:e.title_tr,description_en:e.description_en,description_tr:e.description_tr}).eq("id",e.id);if(r)throw r;a.success(V("content_updated_successfully")||"İçerik başarıyla güncellendi")}else{const{error:r}=await s.from("homepage_content").insert({section:"design",title_en:e.title_en,title_tr:e.title_tr,description_en:e.description_en,description_tr:e.description_tr});if(r)throw r;a.success(V("content_created_successfully")||"İçerik başarıyla oluşturuldu")}const{data:r,error:t}=await s.from("homepage_content").select("*").eq("section","design").single();if(t&&"PGRST116"!==t.code)throw t;r&&H(r),J(!1)}catch(r){a.error(V("error_saving_content")||"İçerik kaydedilirken hata oluştu")}})),className:"space-y-4",children:[r.jsx(R,{control:me.control,name:"title_en",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Title (EN)"}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:me.control,name:"title_tr",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Title (TR)"}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:me.control,name:"description_en",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Description (EN)"}),r.jsx(E,{children:r.jsx(C,{...e,rows:3})})]})}),r.jsx(R,{control:me.control,name:"description_tr",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Description (TR)"}),r.jsx(E,{children:r.jsx(C,{...e,rows:3})})]})}),r.jsxs(y,{children:[r.jsx(u,{type:"button",variant:"outline",onClick:()=>J(!1),children:V("cancel")||"İptal"}),r.jsx(u,{type:"submit",children:V("save")||"Kaydet"})]})]})})]})}),r.jsx(h,{open:Z,onOpenChange:ee,children:r.jsxs(_,{className:"sm:max-w-[600px]",children:[r.jsxs(j,{children:[r.jsx(g,{children:se?V("edit_design_template")||"Tasarım Şablonunu Düzenle":V("create_design_template")||"Tasarım Şablonu Oluştur"}),r.jsx(f,{children:V("design_template_instructions")||"Tasarım şablonu detaylarını girin"})]}),r.jsx(q,{...ue,children:r.jsxs("form",{onSubmit:ue.handleSubmit((async e=>{try{if(e.id){const{error:r}=await s.from("design_templates").update({name:e.name,name_tr:e.name_tr,type:e.type,model_url:e.model_url||null,texture_url:e.texture_url||null,preview_url:e.preview_url,is_active:e.is_active,display_order:e.display_order}).eq("id",e.id);if(r)throw r;a.success(V("template_updated_successfully")||"Şablon başarıyla güncellendi")}else{const{error:r}=await s.from("design_templates").insert({name:e.name,name_tr:e.name_tr,type:e.type,model_url:e.model_url||null,texture_url:e.texture_url||null,preview_url:e.preview_url,is_active:e.is_active,display_order:e.display_order});if(r)throw r;a.success(V("template_created_successfully")||"Şablon başarıyla oluşturuldu")}Y(),ee(!1),re(null)}catch(r){a.error(V("error_saving_template")||"Şablon kaydedilirken hata oluştu")}})),className:"space-y-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(R,{control:ue.control,name:"name",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Name (EN)"}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:ue.control,name:"name_tr",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:"Name (TR)"}),r.jsx(E,{children:r.jsx(b,{...e})})]})})]}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.jsx(R,{control:ue.control,name:"type",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:V("template_type")||"Şablon Tipi"}),r.jsx(E,{children:r.jsxs("select",{className:"w-full h-10 rounded-md border border-input bg-background px-3 py-2",...e,children:[r.jsx("option",{value:"2d",children:"2D"}),r.jsx("option",{value:"3d",children:"3D"})]})})]})}),r.jsx(R,{control:ue.control,name:"display_order",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:V("display_order")||"Görüntüleme Sırası"}),r.jsx(E,{children:r.jsx(b,{...e,type:"number",min:"0"})})]})})]}),r.jsx(R,{control:ue.control,name:"preview_url",render:({field:e})=>r.jsxs(z,{children:[r.jsx(D,{children:V("preview_image_url")||"Önizleme Görsel URL"}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:ue.control,name:"model_url",render:({field:e})=>r.jsxs(z,{children:[r.jsxs(D,{children:[V("model_url")||"3D Model URL"," (optional)"]}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:ue.control,name:"texture_url",render:({field:e})=>r.jsxs(z,{children:[r.jsxs(D,{children:[V("texture_url")||"Doku URL"," (optional)"]}),r.jsx(E,{children:r.jsx(b,{...e})})]})}),r.jsx(R,{control:ue.control,name:"is_active",render:({field:e})=>r.jsxs(z,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[r.jsxs("div",{className:"space-y-0.5",children:[r.jsx(D,{className:"text-base",children:V("active_status")||"Aktif Durum"}),r.jsx(O,{children:V("active_status_description")||"Şablon kullanıcılara gösterilecek"})]}),r.jsx(E,{children:r.jsx(S,{checked:e.value,onCheckedChange:e.onChange})})]})}),r.jsxs(y,{children:[r.jsx(u,{type:"button",variant:"outline",onClick:()=>ee(!1),children:V("cancel")||"İptal"}),r.jsx(u,{type:"submit",children:V("save")||"Kaydet"})]})]})})]})})]})};export{L as default};
