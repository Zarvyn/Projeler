import{j as e,J as r,X as s,aK as a,aL as l}from"./03-hero-critical-BKzCa96P.js";import{r as i}from"./01-react-core-DCvPBpDR.js";import{B as t,D as o,j as c,k as n,l as d,o as m}from"./04-ui-components-DpbmxBFV.js";import{I as g}from"./99-image-uploader-KY2aE3Hk.js";import{ensureBucketsExist as u,checkBucketExists as x}from"./99-ensureBuckets-oAmkppU8.js";import{I as h}from"./05-admin-bundle-BW3OFzIa.js";import{B as j}from"./99-badge-CpQK4qLU.js";function f({currentImages:f=[],onImagesUpdated:p,bucketName:y="story-images",folderPath:k="images",maxImages:b=10}){i.useState(!1);const[v,N]=i.useState(!1),[w,R]=i.useState("");return i.useEffect((()=>{(async()=>{await u(),await x("story-images")||r.error("Required storage bucket not found. Please contact the administrator.")})()}),[]),e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[f.map(((a,l)=>e.jsxs("div",{className:"relative rounded-md overflow-hidden border border-gray-200 dark:border-gray-700",children:[e.jsx("img",{src:a,alt:`Image ${l+1}`,className:"w-full h-auto object-cover aspect-square",onError:e=>{e.target.src="https://via.placeholder.com/300?text=Image+Error",r.error(`Resim yüklenemedi: ${a}`)}}),e.jsx(t,{size:"icon",variant:"destructive",className:"absolute top-2 right-2 h-7 w-7 rounded-full",onClick:()=>(e=>{const r=f.filter(((r,s)=>s!==e));p(r)})(l),children:e.jsx(s,{className:"h-3.5 w-3.5"})}),0===l&&e.jsx(j,{className:"absolute bottom-2 left-2 bg-primary",children:"Ana Görsel"})]},l))),f.length<b&&e.jsx("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-md aspect-square flex flex-col items-center justify-center p-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center h-full w-full",children:[e.jsx(a,{className:"h-10 w-10 text-gray-400 dark:text-gray-600 mb-2"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Görsel Ekle"}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsx(g,{currentImageUrl:"",onImageUploaded:e=>{if(e){if(f.length>=b)return void r.error(`En fazla ${b} resim yükleyebilirsiniz`);const s=[...f,e];p(s)}},bucketName:y,folderPath:k}),e.jsxs(t,{variant:"outline",onClick:()=>N(!0),children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"URL"]})]})]})})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 text-center",children:[f.length," / ",b," resim yüklendi. İlk resim ana görsel olarak kullanılacaktır."]}),e.jsx(o,{open:v,onOpenChange:N,children:e.jsxs(c,{className:"sm:max-w-[425px]",children:[e.jsx(n,{children:e.jsx(d,{children:"Resim URL'si Girin"})}),e.jsx("div",{className:"py-4",children:e.jsx(h,{placeholder:"https://example.com/image.jpg",value:w,onChange:e=>R(e.target.value),className:"w-full"})}),e.jsxs(m,{children:[e.jsx(t,{variant:"outline",onClick:()=>N(!1),children:"İptal"}),e.jsx(t,{onClick:()=>{if(!w||!w.trim())return void r.error("Geçerli bir URL girin");if(f.length>=b)return r.error(`En fazla ${b} resim yükleyebilirsiniz`),void N(!1);try{new URL(w)}catch(s){return void r.error("Geçerli bir URL girin")}const e=[...f,w];p(e),N(!1),R(""),r.success("Resim URL başarıyla eklendi")},children:"Ekle"})]})]})})]})}export{f as M};
