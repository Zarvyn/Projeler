import{n as e,s as t,J as i,j as s,a7 as r,aU as l,aG as n,aF as a}from"./03-hero-critical-BKzCa96P.js";import{r as c}from"./01-react-core-DCvPBpDR.js";import{B as d,C as o,g as h,h as u,i as _,f as m}from"./04-ui-components-DpbmxBFV.js";import{I as x}from"./05-admin-bundle-BW3OFzIa.js";import{L as j}from"./99-label-DtO75rKq.js";import{S as v}from"./99-switch-BaDU39Q5.js";import{T as p,a as f,b as k,c as g,d as y,e as w}from"./99-table-DV3dN7kr.js";import{S as N,a as C,b,c as B,d as S}from"./99-select-CL9TI2Dz.js";import{T as L,a as F,b as E,c as A}from"./99-tabs-CCs0hPp1.js";import"./02-react-router-l50u7dmW.js";import"./06-utils-QQqVvbBo.js";import"./99-index-D5v_MFz8.js";import"./99-index-CxCer4qO.js";const I=()=>{const{t:o,language:h}=e(),[u,_]=c.useState([]),[m,N]=c.useState(!0),[C,b]=c.useState(!1),[B,S]=c.useState({section:"",title_tr:"",title_en:"",is_active:!0,display_order:0});c.useEffect((()=>{L()}),[]);const L=async()=>{N(!0);try{const{data:e,error:i}=await t.from("footer_content").select("*").order("display_order",{ascending:!0});if(i)throw i;_(e||[])}catch(e){i.error(o("content_load_error")||"İçerik yüklenirken hata oluştu")}finally{N(!1)}},F=(e,t,i)=>{const s=[...u];s[e]={...s[e],[t]:i},_(s)};return m?s.jsx("div",{className:"flex justify-center items-center p-10",children:s.jsx(r,{className:"h-10 w-10 animate-spin text-primary"})}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"rounded-md border",children:s.jsxs(p,{children:[s.jsx(f,{children:s.jsxs(k,{children:[s.jsx(g,{children:o("section_key")||"Bölüm Anahtarı"}),s.jsx(g,{children:o("title_tr")||"Başlık (TR)"}),s.jsx(g,{children:o("title_en")||"Başlık (EN)"}),s.jsx(g,{children:o("order")||"Sıra"}),s.jsx(g,{children:o("active")||"Aktif"}),s.jsx(g,{className:"text-right",children:o("actions")||"İşlemler"})]})}),s.jsx(y,{children:u.map(((e,r)=>s.jsxs(k,{children:[s.jsx(w,{className:"font-medium",children:e.section}),s.jsx(w,{children:s.jsx(x,{value:e.title_tr,onChange:e=>F(r,"title_tr",e.target.value)})}),s.jsx(w,{children:s.jsx(x,{value:e.title_en,onChange:e=>F(r,"title_en",e.target.value)})}),s.jsx(w,{children:s.jsx(x,{type:"number",value:e.display_order,onChange:e=>F(r,"display_order",parseInt(e.target.value)),className:"w-20"})}),s.jsx(w,{children:s.jsx(v,{checked:e.is_active,onCheckedChange:e=>F(r,"is_active",e)})}),s.jsx(w,{className:"text-right",children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(d,{variant:"outline",size:"icon",onClick:()=>(async e=>{try{const{error:s}=await t.from("footer_content").update({title_tr:e.title_tr,title_en:e.title_en,is_active:e.is_active,display_order:e.display_order,updated_at:(new Date).toISOString()}).eq("id",e.id);if(s)throw s;i.success(o("section_updated")||"Bölüm güncellendi"),L()}catch(s){i.error(o("section_update_error")||"Bölüm güncellenirken hata oluştu")}})(e),children:s.jsx(l,{className:"h-4 w-4"})}),s.jsx(d,{variant:"destructive",size:"icon",onClick:()=>(async e=>{var s;try{const{data:r,error:l}=await t.from("footer_links").select("id").eq("section",(null==(s=u.find((t=>t.id===e)))?void 0:s.section)||"");if(l)throw l;if(r&&r.length>0)return void i.error(o("section_has_links")||"Bu bölüme ait linkler var. Önce linkleri silin.");const{error:n}=await t.from("footer_content").delete().eq("id",e);if(n)throw n;i.success(o("section_deleted")||"Bölüm silindi"),L()}catch(r){i.error(o("section_delete_error")||"Bölüm silinirken hata oluştu")}})(e.id),children:s.jsx(n,{className:"h-4 w-4"})})]})})]},e.id)))})]})}),s.jsxs("div",{className:"border rounded-md p-4",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:o("add_new_section")||"Yeni Bölüm Ekle"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-section-key",children:o("section_key")||"Bölüm Anahtarı"}),s.jsx(x,{id:"new-section-key",placeholder:"brand, links, contact, etc.",value:B.section,onChange:e=>S({...B,section:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-order",children:o("order")||"Sıra"}),s.jsx(x,{id:"new-order",type:"number",value:B.display_order,onChange:e=>S({...B,display_order:parseInt(e.target.value)})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-title-tr",children:o("title_tr")||"Başlık (TR)"}),s.jsx(x,{id:"new-title-tr",placeholder:"Bölüm başlığı",value:B.title_tr,onChange:e=>S({...B,title_tr:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-title-en",children:o("title_en")||"Başlık (EN)"}),s.jsx(x,{id:"new-title-en",placeholder:"Section title",value:B.title_en,onChange:e=>S({...B,title_en:e.target.value})})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(v,{id:"new-is-active",checked:B.is_active,onCheckedChange:e=>S({...B,is_active:e})}),s.jsx(j,{htmlFor:"new-is-active",children:o("active")||"Aktif"})]}),s.jsxs(d,{onClick:async()=>{if(B.section&&B.title_tr&&B.title_en){b(!0);try{const{error:e}=await t.from("footer_content").insert({section:B.section,title_tr:B.title_tr,title_en:B.title_en,is_active:B.is_active,display_order:B.display_order});if(e)throw e;i.success(o("section_created")||"Bölüm oluşturuldu"),S({section:"",title_tr:"",title_en:"",is_active:!0,display_order:u.length}),L()}catch(e){i.error(o("section_create_error")||"Bölüm oluşturulurken hata oluştu")}finally{b(!1)}}else i.error(o("fill_required_fields")||"Lütfen tüm gerekli alanları doldurun")},disabled:C,className:"w-full",children:[C&&s.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"}),s.jsx(a,{className:"h-4 w-4 mr-2"}),o("add_section")||"Bölüm Ekle"]})]})]})},q=()=>{const{t:o}=e(),[h,u]=c.useState([]),[_,m]=c.useState([]),[L,F]=c.useState(!0),[E,A]=c.useState(!1),[I,q]=c.useState({section:"",title_tr:"",title_en:"",url:"",is_active:!0,display_order:0});c.useEffect((()=>{z()}),[]);const z=async()=>{F(!0);try{const{data:e,error:i}=await t.from("footer_content").select("id, section, title_tr, title_en").order("display_order",{ascending:!0});if(i)throw i;m(e||[]);const{data:s,error:r}=await t.from("footer_links").select("*").order("section",{ascending:!0}).order("display_order",{ascending:!0});if(r)throw r;u(s||[]),e&&e.length>0&&q((t=>({...t,section:e[0].section})))}catch(e){i.error(o("content_load_error")||"İçerik yüklenirken hata oluştu")}finally{F(!1)}},R=(e,t,i)=>{const s=[...h];s[e]={...s[e],[t]:i},u(s)},T={};return h.forEach((e=>{T[e.section]||(T[e.section]=[]),T[e.section].push(e)})),L?s.jsx("div",{className:"flex justify-center items-center p-10",children:s.jsx(r,{className:"h-10 w-10 animate-spin text-primary"})}):s.jsxs("div",{className:"space-y-6",children:[Object.entries(T).map((([e,r])=>{var a;const c=(null==(a=_.find((t=>t.section===e)))?void 0:a.title_tr)||e;return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium",children:c}),s.jsx("div",{className:"rounded-md border",children:s.jsxs(p,{children:[s.jsx(f,{children:s.jsxs(k,{children:[s.jsx(g,{children:o("title_tr")||"Başlık (TR)"}),s.jsx(g,{children:o("title_en")||"Başlık (EN)"}),s.jsx(g,{children:o("url")||"URL"}),s.jsx(g,{children:o("order")||"Sıra"}),s.jsx(g,{children:o("active")||"Aktif"}),s.jsx(g,{className:"text-right",children:o("actions")||"İşlemler"})]})}),s.jsx(y,{children:r.map(((e,r)=>{const a=h.findIndex((t=>t.id===e.id));return s.jsxs(k,{children:[s.jsx(w,{children:s.jsx(x,{value:e.title_tr,onChange:e=>R(a,"title_tr",e.target.value)})}),s.jsx(w,{children:s.jsx(x,{value:e.title_en,onChange:e=>R(a,"title_en",e.target.value)})}),s.jsx(w,{children:s.jsx(x,{value:e.url,onChange:e=>R(a,"url",e.target.value)})}),s.jsx(w,{children:s.jsx(x,{type:"number",value:e.display_order,onChange:e=>R(a,"display_order",parseInt(e.target.value)),className:"w-20"})}),s.jsx(w,{children:s.jsx(v,{checked:e.is_active,onCheckedChange:e=>R(a,"is_active",e)})}),s.jsx(w,{className:"text-right",children:s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx(d,{variant:"outline",size:"icon",onClick:()=>(async e=>{try{const{error:s}=await t.from("footer_links").update({section:e.section,title_tr:e.title_tr,title_en:e.title_en,url:e.url,is_active:e.is_active,display_order:e.display_order,updated_at:(new Date).toISOString()}).eq("id",e.id);if(s)throw s;i.success(o("link_updated")||"Link güncellendi"),z()}catch(s){i.error(o("link_update_error")||"Link güncellenirken hata oluştu")}})(e),children:s.jsx(l,{className:"h-4 w-4"})}),s.jsx(d,{variant:"destructive",size:"icon",onClick:()=>(async e=>{try{const{error:s}=await t.from("footer_links").delete().eq("id",e);if(s)throw s;i.success(o("link_deleted")||"Link silindi"),z()}catch(s){i.error(o("link_delete_error")||"Link silinirken hata oluştu")}})(e.id),children:s.jsx(n,{className:"h-4 w-4"})})]})})]},e.id)}))})]})})]},e)})),s.jsxs("div",{className:"border rounded-md p-4",children:[s.jsx("h3",{className:"text-lg font-medium mb-4",children:o("add_new_link")||"Yeni Link Ekle"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-link-section",children:o("section")||"Bölüm"}),s.jsxs(N,{value:I.section,onValueChange:e=>q({...I,section:e}),children:[s.jsx(C,{id:"new-link-section",children:s.jsx(b,{placeholder:o("select_section")||"Bölüm seç"})}),s.jsx(B,{children:_.map((e=>s.jsx(S,{value:e.section,children:e.title_tr},e.id)))})]})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-link-order",children:o("order")||"Sıra"}),s.jsx(x,{id:"new-link-order",type:"number",value:I.display_order,onChange:e=>q({...I,display_order:parseInt(e.target.value)})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-link-title-tr",children:o("title_tr")||"Başlık (TR)"}),s.jsx(x,{id:"new-link-title-tr",placeholder:"Link başlığı",value:I.title_tr,onChange:e=>q({...I,title_tr:e.target.value})})]}),s.jsxs("div",{children:[s.jsx(j,{htmlFor:"new-link-title-en",children:o("title_en")||"Başlık (EN)"}),s.jsx(x,{id:"new-link-title-en",placeholder:"Link title",value:I.title_en,onChange:e=>q({...I,title_en:e.target.value})})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx(j,{htmlFor:"new-link-url",children:o("url")||"URL"}),s.jsx(x,{id:"new-link-url",placeholder:"https://example.com",value:I.url,onChange:e=>q({...I,url:e.target.value})})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[s.jsx(v,{id:"new-link-is-active",checked:I.is_active,onCheckedChange:e=>q({...I,is_active:e})}),s.jsx(j,{htmlFor:"new-link-is-active",children:o("active")||"Aktif"})]}),s.jsxs(d,{onClick:async()=>{if(I.section&&I.title_tr&&I.title_en&&I.url){A(!0);try{const{error:e}=await t.from("footer_links").insert({section:I.section,title_tr:I.title_tr,title_en:I.title_en,url:I.url,is_active:I.is_active,display_order:I.display_order});if(e)throw e;i.success(o("link_created")||"Link oluşturuldu"),q({section:I.section,title_tr:"",title_en:"",url:"",is_active:!0,display_order:h.filter((e=>e.section===I.section)).length}),z()}catch(e){i.error(o("link_create_error")||"Link oluşturulurken hata oluştu")}finally{A(!1)}}else i.error(o("fill_required_fields")||"Lütfen tüm gerekli alanları doldurun")},disabled:E,className:"w-full",children:[E&&s.jsx(r,{className:"mr-2 h-4 w-4 animate-spin"}),s.jsx(a,{className:"h-4 w-4 mr-2"}),o("add_link")||"Link Ekle"]})]})]})},z=()=>{const{t:t}=e();return s.jsx("div",{className:"space-y-6",children:s.jsxs(o,{children:[s.jsxs(h,{children:[s.jsx(u,{children:t("footer_settings")||"Footer Ayarları"}),s.jsx(_,{children:t("footer_settings_description")||"Sitenizin alt bilgisini düzenleyin ve özelleştirin."})]}),s.jsx(m,{children:s.jsxs(L,{defaultValue:"sections",className:"w-full",children:[s.jsxs(F,{className:"grid w-full grid-cols-2",children:[s.jsx(E,{value:"sections",children:t("footer_sections")||"Alt Bilgi Bölümleri"}),s.jsx(E,{value:"links",children:t("footer_links")||"Alt Bilgi Linkleri"})]}),s.jsx(A,{value:"sections",className:"pt-4",children:s.jsx(I,{})}),s.jsx(A,{value:"links",className:"pt-4",children:s.jsx(q,{})})]})})]})})};export{z as default};
